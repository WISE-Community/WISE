{"version":3,"sources":["themeController.es6"],"names":["ThemeController","$scope","$state","$filter","ConfigService","ProjectService","StudentDataService","StudentStatusService","NotebookService","SessionService","$mdDialog","$mdMedia","$mdToast","$mdComponentRegistry","$translate","layoutView","numberProject","themePath","getThemePath","themeSettings","getThemeSettings","hideTotalScores","nodeStatuses","idToOrder","rootNode","rootNodeStatus","id","workgroupId","getWorkgroupId","workgroupUsernames","getUsernamesByWorkgroupId","notebookOpen","notebookConfig","getNotebookConfig","notebookFilter","currentNode","getCurrentNode","planningMode","enabled","type","itemTypes","prop","hasOwnProperty","connectionLostDisplay","build","template","hideDelay","connectionLostShown","setLayoutState","$on","event","args","message","nodeId","node","getNodeById","constraints","getConstraintsForNode","orderConstraints","length","nodeTitle","getNodePositionAndTitleByNodeId","c","constraint","evaluateConstraint","getConstraintMessage","show","alert","parent","angular","element","document","body","title","htmlContent","ariaLabel","ok","targetEvent","ev","confirm","textContent","cancel","then","closeWarningAndRenewSession","undefined","forceLogOut","handleServerDisconnect","handleServerReconnect","revisions","componentController","allowRevert","$event","revisionsTemplateUrl","templateUrl","locals","items","reverse","controller","RevisionsController","close","hide","revertWork","componentState","setStudentWork","studentDataChanged","$inject","studentAssetDialogTemplateUrl","studentAssetTemplateUrl","StudentAssetDialogController","closeDialog","notification","notificationDismissDialogTemplateUrl","dismissCodePrompt","DismissCodeDialogController","NotificationService","input","dismissCode","hasDismissCode","data","nodePositionAndTitle","checkDismissCode","dismissNotification","componentId","componentType","category","eventData","saveVLEEvent","errorMessage","visitNode","goToNodeId","endCurrentNodeAndSetCurrentNodeByNodeId","state","layoutState","isApplicationNode","isGroupNode","go","notebookNavOpen","getAvatarColorForWorkgroupId","mouseMoved"],"mappings":"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","sourcesContent":["'use strict';\n\nclass ThemeController {\n  constructor($scope,\n              $state,\n              $filter,\n              ConfigService,\n              ProjectService,\n              StudentDataService,\n              StudentStatusService,\n              NotebookService,\n              SessionService,\n              $mdDialog,\n              $mdMedia,\n              $mdToast,\n              $mdComponentRegistry) {\n    this.$scope = $scope;\n    this.$state = $state;\n    this.$filter = $filter;\n    this.ConfigService = ConfigService;\n    this.ProjectService = ProjectService;\n    this.StudentDataService = StudentDataService;\n    this.NotebookService = NotebookService;\n    this.SessionService = SessionService;\n    this.StudentStatusService = StudentStatusService;\n    this.$mdDialog = $mdDialog;\n    this.$mdMedia = $mdMedia;\n    this.$mdToast = $mdToast;\n    this.$mdComponentRegistry = $mdComponentRegistry;\n    this.$translate = this.$filter('translate');\n\n    // TODO: set these variables dynamically from theme settings\n    this.layoutView = 'list'; // 'list' or 'card'\n    this.numberProject = true;\n\n    this.themePath = this.ProjectService.getThemePath();\n    this.themeSettings = this.ProjectService.getThemeSettings();\n    this.hideTotalScores = this.themeSettings.hideTotalScores;\n\n    this.nodeStatuses = this.StudentDataService.nodeStatuses;\n    this.idToOrder = this.ProjectService.idToOrder;\n\n    this.rootNode = this.ProjectService.rootNode;\n    this.rootNodeStatus = this.nodeStatuses[this.rootNode.id];\n\n    this.workgroupId = this.ConfigService.getWorkgroupId();\n    this.workgroupUsernames = this.ConfigService.getUsernamesByWorkgroupId(this.workgroupId);\n\n    this.notebookOpen = false;\n    this.notebookConfig = this.NotebookService.getNotebookConfig();\n    this.notebookFilter = '';\n    this.currentNode = this.StudentDataService.getCurrentNode();\n    this.planningMode = false;\n\n    // set current notebook type filter to first enabled type\n    if (this.notebookConfig.enabled) {\n      for (var type in this.notebookConfig.itemTypes) {\n        let prop = this.notebookConfig.itemTypes[type];\n        if (this.notebookConfig.itemTypes.hasOwnProperty(type) && prop.enabled) {\n          this.notebookFilter = type;\n          break;\n        }\n      }\n    }\n\n    // build server disconnect display\n    this.connectionLostDisplay = $mdToast.build({\n      template: \"<md-toast>\\\n                      <span>{{ 'ERROR_CHECK_YOUR_INTERNET_CONNECTION' | translate }}</span>\\\n                      </md-toast>\",\n      hideDelay: 0\n    });\n    this.connectionLostShown = false;\n\n    this.setLayoutState();\n\n    // update layout state when current node changes\n    this.$scope.$on('currentNodeChanged', (event, args) => {\n      this.currentNode = this.StudentDataService.getCurrentNode();\n      this.setLayoutState();\n    });\n\n    // alert user when a locked node has been clicked\n    this.$scope.$on('nodeClickLocked', (event, args) => {\n      var message = this.$translate('sorryYouCannotViewThisItemYet');\n      let nodeId = args.nodeId;\n      var node = this.ProjectService.getNodeById(nodeId);\n      if (node != null) {\n        // get the constraints that affect this node\n        var constraints = this.ProjectService.getConstraintsForNode(node);\n        this.ProjectService.orderConstraints(constraints);\n\n        if (constraints != null && constraints.length > 0) {\n          // get the node title the student is trying to go to\n          let nodeTitle = this.ProjectService.getNodePositionAndTitleByNodeId(nodeId);\n          message = this.$translate('toVisitNodeTitleYouNeedTo', { nodeTitle: nodeTitle });\n        }\n\n        // loop through all the constraints that affect this node\n        for (var c = 0; c < constraints.length; c++) {\n          var constraint = constraints[c];\n\n          // check if the constraint has been satisfied\n          if (constraint != null && !this.StudentDataService.evaluateConstraint(node, constraint)) {\n            // the constraint has not been satisfied and is still active\n\n            if (message != '') {\n              // separate multiple constraints with line breaks\n              message += '<br/>';\n            }\n\n            // get the message that describes how to disable the constraint\n            message += this.ProjectService.getConstraintMessage(nodeId, constraint);\n          }\n        }\n      }\n\n      this.$mdDialog.show(\n        this.$mdDialog.alert()\n          .parent(angular.element(document.body))\n          .title(this.$translate('itemLocked'))\n          .htmlContent(message)\n          .ariaLabel(this.$translate('itemLocked'))\n          .ok(this.$translate('ok'))\n          .targetEvent(event)\n      );\n    });\n\n    // alert user when inactive for a long time\n    this.$scope.$on('showSessionWarning', (ev) => {\n      let alert = this.$mdDialog.confirm()\n        .parent(angular.element(document.body))\n        .title(this.$translate('sessionTimeout'))\n        .textContent(this.$translate('autoLogoutMessage'))\n        .ariaLabel(this.$translate('sessionTimeout'))\n        .targetEvent(ev)\n        .ok(this.$translate('yes'))\n        .cancel(this.$translate('no'));\n\n      this.$mdDialog.show(alert).then(() => {\n        this.SessionService.closeWarningAndRenewSession();\n        alert = undefined;\n      }, () => {\n        this.SessionService.forceLogOut();\n      });\n    });\n\n    // alert user when inactive for a long time\n    this.$scope.$on('showRequestLogout', (ev) => {\n      let alert = this.$mdDialog.confirm()\n        .parent(angular.element(document.body))\n        .title(this.$translate('serverUpdate'))\n        .textContent(this.$translate('serverUpdateRequestLogoutMessage'))\n        .ariaLabel(this.$translate('serverUpdate'))\n        .targetEvent(ev)\n        .ok(this.$translate('ok'));\n\n      this.$mdDialog.show(alert).then(() => {\n        // do nothing\n      }, () => {\n        // do nothing\n      });\n    });\n\n    // alert user when server loses connection\n    this.$scope.$on('serverDisconnected', () => {\n      this.handleServerDisconnect();\n    });\n\n    // remove alert when server regains connection\n    this.$scope.$on('serverConnected', () => {\n      this.handleServerReconnect();\n    });\n\n    // show list of revisions in a dialog when user clicks the show revisions link for a component\n    this.$scope.$on('showRevisions', (event, args) => {\n      let revisions = args.revisions;\n      let componentController = args.componentController;\n      let allowRevert = args.allowRevert;\n      let $event = args.$event;\n      let revisionsTemplateUrl = this.themePath + '/templates/componentRevisions.html';\n\n      this.$mdDialog.show({\n        parent: angular.element(document.body),\n        targetEvent: $event,\n        templateUrl: revisionsTemplateUrl,\n        locals: {\n          items: revisions.reverse(),\n          componentController: componentController,\n          allowRevert: allowRevert\n        },\n        controller: RevisionsController\n      });\n      function RevisionsController($scope, $mdDialog, items, componentController, allowRevert) {\n        $scope.items = items;\n        $scope.componentController = componentController;\n        $scope.allowRevert = allowRevert;\n        $scope.close = () => {\n          $mdDialog.hide();\n        };\n        $scope.revertWork = (componentState) => {\n          $scope.componentController.setStudentWork(componentState);\n          $scope.componentController.studentDataChanged();\n          $mdDialog.hide();\n        };\n      }\n      RevisionsController.$inject = [\"$scope\", \"$mdDialog\", \"items\", \"componentController\", \"allowRevert\"];\n    });\n\n    this.$scope.$on('showStudentAssets', (event, args) => {\n      let componentController = args.componentController;\n      let $event = args.$event;\n      let studentAssetDialogTemplateUrl = this.themePath + '/templates/studentAssetDialog.html';\n      let studentAssetTemplateUrl = this.themePath + '/studentAsset/studentAsset.html';\n\n      this.$mdDialog.show({\n        parent: angular.element(document.body),\n        targetEvent: $event,\n        templateUrl: studentAssetDialogTemplateUrl,\n        locals: {\n          studentAssetTemplateUrl: studentAssetTemplateUrl,\n          componentController: componentController\n        },\n        controller: StudentAssetDialogController\n      });\n      function StudentAssetDialogController($scope, $mdDialog, componentController) {\n        $scope.studentAssetTemplateUrl = studentAssetTemplateUrl;\n        $scope.componentController = componentController;\n        $scope.closeDialog = function () {\n          $mdDialog.hide();\n        }\n      }\n      StudentAssetDialogController.$inject = [\"$scope\", \"$mdDialog\", \"componentController\"];\n    });\n\n    // a group node has turned on or off planning mode\n    this.$scope.$on('togglePlanningMode', (event, args) => {\n      this.planningMode = args.planningMode;\n    });\n\n    // handle request for notification dismiss codes\n    this.$scope.$on('viewCurrentAmbientNotification', (event, args) => {\n      let notification = args.notification;\n      let ev = args.event;\n      let notificationDismissDialogTemplateUrl = this.themePath + '/templates/notificationDismissDialog.html';\n\n      let dismissCodePrompt = {\n        parent: angular.element(document.body),\n        targetEvent: ev,\n        templateUrl: notificationDismissDialogTemplateUrl,\n        locals: {\n          notification: notification\n        },\n        controller: DismissCodeDialogController\n      };\n      DismissCodeDialogController.$inject = ['$scope', '$mdDialog', '$filter', 'NotificationService', 'ProjectService', 'StudentDataService', 'notification'];\n\n      function DismissCodeDialogController($scope, $mdDialog, $filter, NotificationService, ProjectService, StudentDataService, notification) {\n\n        $scope.$translate = $filter('translate');\n\n        $scope.input = {\n          dismissCode: \"\"\n        };\n        $scope.message = \"\";\n        $scope.notification = notification;\n        $scope.hasDismissCode = false;\n        if (notification.data) {\n          if (notification.data.dismissCode) {\n            $scope.hasDismissCode = true;\n          }\n        }\n        $scope.nodePositionAndTitle = ProjectService.getNodePositionAndTitleByNodeId(notification.nodeId);\n\n        $scope.checkDismissCode = function() {\n          if (!$scope.hasDismissCode || ($scope.input.dismissCode == notification.data.dismissCode)) {\n            NotificationService.dismissNotification(notification);\n            $mdDialog.hide();\n            // log currentAmbientNotificationDimissed event\n            var nodeId = null;\n            var componentId = null;\n            var componentType = null;\n            var category = \"Notification\";\n            var event = \"currentAmbientNotificationDimissedWithCode\";\n            var eventData = {};\n            StudentDataService.saveVLEEvent(nodeId, componentId, componentType, category, event, eventData);\n          } else {\n            $scope.errorMessage = $scope.$translate('dismissNotificationInvalidDismissCode');\n          }\n        };\n        $scope.visitNode = function() {\n          if (!$scope.hasDismissCode) {\n            // only dismiss notifications that don't require a dismiss code, but still allow them to move to the node\n            NotificationService.dismissNotification(null, $scope.notification);\n          }\n\n          let goToNodeId = $scope.notification.nodeId;\n          if (goToNodeId != null) {\n            StudentDataService.endCurrentNodeAndSetCurrentNodeByNodeId(goToNodeId);\n          }\n        };\n\n        $scope.closeDialog = function() {\n          $mdDialog.hide();\n\n          // log currentAmbientNotificationWindowClosed event\n          var nodeId = null;\n          var componentId = null;\n          var componentType = null;\n          var category = \"Notification\";\n          var event = \"currentAmbientNotificationWindowClosed\";\n          var eventData = {};\n          StudentDataService.saveVLEEvent(nodeId, componentId, componentType, category, event, eventData);\n        }\n      }\n\n      this.$mdDialog.show(dismissCodePrompt);\n\n      // log currentAmbientNotificationWindowOpened event\n      var nodeId = null;\n      var componentId = null;\n      var componentType = null;\n      var category = \"Notification\";\n      var event = \"currentAmbientNotificationWindowOpened\";\n      var eventData = {};\n      this.StudentDataService.saveVLEEvent(nodeId, componentId, componentType, category, event, eventData);\n    });\n  }\n\n  /**\n   * Set the layout state of the vle\n   * @param state string specifying state (e.g. 'notebook'; optional)\n   */\n  setLayoutState(state) {\n    let layoutState = 'nav'; // default layout state\n    if (state) {\n      layoutState = state;\n    } else {\n      // no state was sent, so set based on current node\n      if (this.currentNode) {\n        var id = this.currentNode.id;\n        if (this.ProjectService.isApplicationNode(id)) {\n          // currently viewing step, so show step view\n          layoutState = 'node';\n        } else if (this.ProjectService.isGroupNode(id)) {\n          // currently viewing group node, so show navigation view\n          layoutState = 'nav';\n        }\n      }\n    }\n\n    if (layoutState === 'notebook') {\n      this.$state.go('root.notebook', {nodeId: this.currentNode.id});\n    } else {\n      this.notebookNavOpen = false;\n      this.$state.go('root.vle', {nodeId: this.currentNode.id});\n    }\n\n    this.layoutState = layoutState;\n  }\n\n  handleServerDisconnect() {\n    if (!this.connectionLostShown) {\n      this.$mdToast.show(this.connectionLostDisplay);\n      this.connectionLostShown = true;\n    }\n  }\n\n  handleServerReconnect() {\n    this.$mdToast.hide(this.connectionLostDisplay);\n    this.connectionLostShown = false;\n  }\n\n  getAvatarColorForWorkgroupId(workgroupId) {\n    return this.ConfigService.getAvatarColorForWorkgroupId(workgroupId);\n  }\n\n  mouseMoved() {\n    /*\n     * notify the Session Service that the user has moved the mouse\n     * so we can refresh the session\n     */\n    this.SessionService.mouseMoved();\n  }\n}\n\nThemeController.$inject = [\n  '$scope',\n  '$state',\n  '$filter',\n  'ConfigService',\n  'ProjectService',\n  'StudentDataService',\n  'StudentStatusService',\n  'NotebookService',\n  'SessionService',\n  '$mdDialog',\n  '$mdMedia',\n  '$mdToast',\n  '$mdComponentRegistry'\n];\n\nexport default ThemeController;\n"],"file":"themeController.js"}