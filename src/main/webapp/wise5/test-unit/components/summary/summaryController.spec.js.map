{"version":3,"sources":["src/main/webapp/wise5/test-unit/components/summary/summaryController.spec.es6"],"names":["multipleChoiceComponent","id","type","prompt","showSaveButton","showSubmitButton","choices","feedback","text","isCorrect","displayMultipleChoiceSummaryComponent","summaryNodeId","summaryComponentId","source","studentDataType","chartType","requirementToSeeSummary","highlightCorrectAnswer","openResponseComponent","mockStudentDataService","getComponentStatesByNodeIdAndComponentId","nodeId","componentId","componentStates","componentState","componentType","studentData","studentChoices","push","response","isSubmit","isCompleted","mockProjectService","getComponentByNodeIdAndComponentId","describe","$controller","$rootScope","$scope","summaryController","component","loadComponent","$new","componentContent","JSON","parse","stringify","ProjectService","StudentDataService","beforeEach","angular","mock","module","mainModule","name","inject","_$controller_","_$rootScope_","it","prompt1","getOtherPrompt","expect","toEqual","prompt2","isStudentHasWork","toBeFalsy","toBeTruthy","calculateIsShowDisplay","spyOn","ConfigService","and","returnValue","setPeriodIdIfNecessary","periodId"],"mappings":"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","sourcesContent":["import angular from 'angular';\r\nimport mainModule from 'vle/main';\r\nimport 'angular-mocks';\r\n\r\nconst multipleChoiceComponent = {\r\n  id: '87df23g4l7',\r\n  type: 'MultipleChoice',\r\n  prompt: 'What is your favorite color?',\r\n  showSaveButton: true,\r\n  showSubmitButton: true,\r\n  choices: [\r\n      {\r\n          feedback: '',\r\n          id: 'hpke1oyd25',\r\n          text: 'Red',\r\n          isCorrect: false\r\n      },\r\n      {\r\n          feedback: '',\r\n          id: 'e7qc47iktb',\r\n          text: 'Blue',\r\n          isCorrect: false\r\n      },\r\n      {\r\n          feedback: '',\r\n          id: 'ju4eh3e7jx',\r\n          text: 'Green',\r\n          isCorrect: true\r\n      }\r\n  ]\r\n};\r\n\r\nconst displayMultipleChoiceSummaryComponent = {\r\n  id: 'z87vj05pjh',\r\n  type: 'Summary',\r\n  prompt: '',\r\n  showSaveButton: true,\r\n  showSubmitButton: true,\r\n  summaryNodeId: 'node1',\r\n  summaryComponentId: '87df23g4l7',\r\n  source: 'period',\r\n  studentDataType: 'responses',\r\n  chartType: 'column',\r\n  requirementToSeeSummary: 'none',\r\n  highlightCorrectAnswer: false\r\n};\r\n\r\nconst openResponseComponent = {\r\n  id: '4j4en745m7',\r\n  type: 'OpenResponse',\r\n  prompt: 'Explain the best toppings on a pizza.',\r\n  showSaveButton: true,\r\n  showSubmitButton: true\r\n};\r\n\r\nconst mockStudentDataService = {\r\n  getComponentStatesByNodeIdAndComponentId(nodeId, componentId) {\r\n    const componentStates = [];\r\n    if (componentId === '87df23g4l7') {\r\n      const componentState = {\r\n        componentType: 'MultipleChoice',\r\n        studentData: {\r\n          studentChoices: [\r\n            { id: 'e7qc47iktb', text: 'Blue' }\r\n          ]\r\n        }\r\n      };\r\n      componentStates.push(componentState);\r\n    } else if (componentId === '4j4en745m7') {\r\n      const componentState = {\r\n        componentType: 'OpenResponse',\r\n        studentData: {\r\n          response: 'Add pepperoni.'\r\n        },\r\n        isSubmit: true\r\n      };\r\n      componentStates.push(componentState);\r\n    }\r\n    return componentStates;\r\n  },\r\n  isCompleted(nodeId, componentId) {\r\n    return componentId === '87df23g4l7' || componentId === '4j4en745m7';\r\n  }\r\n};\r\n\r\nconst mockProjectService = {\r\n  getComponentByNodeIdAndComponentId(nodeId, componentId) {\r\n    if (componentId === '87df23g4l7') {\r\n      return multipleChoiceComponent;\r\n    } else if (componentId === '4j4en745m7') {\r\n      return openResponseComponent;\r\n    }\r\n  }\r\n}\r\n\r\ndescribe('SummaryController', () => {\r\n\r\n  let $controller;\r\n  let $rootScope;\r\n  let $scope;\r\n  let summaryController;\r\n  let component;\r\n\r\n  const loadComponent = () => {\r\n    $scope = $rootScope.$new();\r\n    $scope.componentContent = JSON.parse(JSON.stringify(component));\r\n    summaryController = $controller('SummaryController',\r\n        {\r\n          $scope: $scope,\r\n          ProjectService: mockProjectService, \r\n          StudentDataService: mockStudentDataService\r\n        });\r\n    summaryController.nodeId = 'node1';\r\n  };\r\n\r\n  beforeEach(angular.mock.module(mainModule.name));\r\n\r\n  beforeEach(inject((_$controller_, _$rootScope_) => {\r\n    $controller = _$controller_;\r\n    $rootScope = _$rootScope_;\r\n    component = displayMultipleChoiceSummaryComponent;\r\n    loadComponent();\r\n  }));\r\n\r\n  it('should get the prompt from the other component', () => {\r\n    const prompt1 = summaryController.getOtherPrompt('node1', '87df23g4l7');\r\n    expect(prompt1).toEqual('What is your favorite color?');\r\n    const prompt2 = summaryController.getOtherPrompt('node1', '4j4en745m7');\r\n    expect(prompt2).toEqual('Explain the best toppings on a pizza.');\r\n  });\r\n\r\n  it('should check if the student has work', () => {\r\n    summaryController.summaryNodeId = 'node1';\r\n    summaryController.summaryComponentId = '1111111111';\r\n    expect(summaryController.isStudentHasWork()).toBeFalsy();\r\n    summaryController.summaryNodeId = 'node1';\r\n    summaryController.summaryComponentId = '87df23g4l7';\r\n    expect(summaryController.isStudentHasWork()).toBeTruthy();\r\n  });\r\n\r\n  it('should calculate if the display should be shown when the requirement is submit work', () => {\r\n    summaryController.summaryNodeId = 'node1';\r\n    summaryController.summaryComponentId = '87df23g4l7';\r\n    summaryController.componentContent.requirementToSeeSummary = 'submitWork';\r\n    expect(summaryController.calculateIsShowDisplay()).toBeFalsy();\r\n    summaryController.summaryNodeId = 'node1';\r\n    summaryController.summaryComponentId = '4j4en745m7';\r\n    summaryController.componentContent.requirementToSeeSummary = 'submitWork';\r\n    expect(summaryController.calculateIsShowDisplay()).toBeTruthy();\r\n  });\r\n\r\n  it('should calculate if the display should be shown when the requirement is complete component', \r\n      () => {\r\n    summaryController.summaryNodeId = 'node1';\r\n    summaryController.summaryComponentId = '1111111111';\r\n    summaryController.componentContent.requirementToSeeSummary = 'completeComponent';\r\n    expect(summaryController.calculateIsShowDisplay()).toBeFalsy();\r\n    summaryController.summaryNodeId = 'node1';\r\n    summaryController.summaryComponentId = '4j4en745m7';\r\n    summaryController.componentContent.requirementToSeeSummary = 'completeComponent';\r\n    expect(summaryController.calculateIsShowDisplay()).toBeTruthy();\r\n  });\r\n\r\n  it('should calculate if the display should be shown when the requirement is none', () => {\r\n    summaryController.summaryNodeId = 'node1';\r\n    summaryController.summaryComponentId = '1111111111';\r\n    summaryController.componentContent.requirementToSeeSummary = 'none';\r\n    expect(summaryController.calculateIsShowDisplay()).toBeTruthy();\r\n    summaryController.summaryNodeId = 'node1';\r\n    summaryController.summaryComponentId = '4j4en745m7';\r\n    summaryController.componentContent.requirementToSeeSummary = 'none';\r\n    expect(summaryController.calculateIsShowDisplay()).toBeTruthy();\r\n  });\r\n\r\n  it('should set the period id', () => {\r\n    spyOn(summaryController.ConfigService, 'isStudentRun').and.returnValue(true);\r\n    spyOn(summaryController.ConfigService, 'getPeriodId').and.returnValue(123456); \r\n    summaryController.componentContent.source = 'period';\r\n    summaryController.setPeriodIdIfNecessary();\r\n    expect(summaryController.periodId).toEqual(123456);\r\n    summaryController.componentContent.source = 'allPeriods';\r\n    summaryController.setPeriodIdIfNecessary();\r\n    expect(summaryController.periodId).toEqual(null);\r\n  });\r\n\r\n});\r\n"],"file":"summaryController.spec.js"}